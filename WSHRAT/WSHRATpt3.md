## Part 2

Part two can be found here:
https://github.com/VenzoV/MalwareAnalysisReports/blob/main/WSHRAT/WSHRATpt2.md


## C2 commands


From part two we took a look at the malware making contact with the C2 to receive instructions. The response is parsed, and split on the pipe character.
There are many different commands that the malware can run.
This is all done through a switch statement.
Also, worth noting that the the code sends feedback and error messages to the C2 such as failed installations or failed to recover password.


| Commands | Description |
| ------------- | ------------- |
| disconnect  | Calls wscript to quit process  |
| reboot  | calls %comspec% /c shutdown /r /t /0 /f to reboot the host  |
| shutdown  | calls %comspec% /c shutdown /s /t /0 /f to shutdown the host  |
| execute  | calls eval on the second parameter returned from the first post request  |
| install-sdk  | posts "moz-sdk" to C2 with the post() function, fetches "wshsdk.zip" and unzips it to appdata/wshsdk folder  |
| remove-sdk  | removes the "wshsdk.zip" file and folder created  |
| get-pass  | Get password from: IE, Chrome, Mozilla ,foxmail |
| get-pass-offline  | Get password from: IE, Chrome, Mozilla ,foxmail. Fetches binary for mailpass view, nirsoft tool for password recovery for outlook. Binary is hardcoded in base64 within the code itself

|